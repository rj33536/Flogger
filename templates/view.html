{% extends 'base.html' %}

{% block body %}
<div class="container">
<div >
<h2>{{blog.title}}</h2>

<p>{{blog.text}}</p>
<div class="row">
{% if user in blog.claps.all %}
<input type="submit" class="text-white bg-primary bold" id="clap" onclick="clap()" value="clap">
{% else %}
<input type="submit" class="text-dark bg-white bold" id="clap" onclick="clap()" value="clap">
{% endif %}
</div>
<div class="fb-like" data-href="{% url 'detail' blog.id %}" data-width="" data-layout="standard" data-action="like" data-size="small" data-share="true"></div>
<br>
<a href="https://twitter.com/Rohitja52232082?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @Rohitja52232082</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<div class="comments">
<textarea name="content"></textarea > 
<input type="submit" onclick="comment" value="Comment">

<ul>
{% for comment in blog.comments.all %}
<li>{{comment.text}}, {{comment.commentator}}</li>
{% endfor %}
</ul>
</div>
</div>
</div>

<script>
function clap() {
    console.log("here");
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
     var res = this.responseText;
     console.log(res);
     if(res=="Success"){
       var btn=document.body.querySelector('#clap');
       console.log(res);
       btn.className="text-white bg-primary bold";
     }
     if(res=='unclap'){
       var btn=document.body.querySelector('#clap');
       console.log(res);
       btn.className="text-dark bg-white bold";
     }
    }
  };
  xhttp.open("GET", "{% url 'clap' blog.id %}", true);
  xhttp.send();
}
</script>

{% endblock body %}

